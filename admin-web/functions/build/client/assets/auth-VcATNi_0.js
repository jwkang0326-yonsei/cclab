import{s as w,a as o,d as g,b as l,g as f,c as e}from"./firebase-3OE0PJgJ.js";async function E(s,a){try{const t=(await w(o,s,a)).user,d=g(l,"users",t.uid),i=await f(d);if(!i.exists())throw await e(o),new Error("Access denied: User profile not found.");const r=i.data(),c=r==null?void 0:r.role,u=r==null?void 0:r.church_id;if(c!=="super-admin")if(c==="admin"){if(!u)throw await e(o),new Error("Access denied: Admin account must be linked to a church.")}else throw await e(o),new Error("Access denied: You do not have administrator privileges.");const h=await t.getIdToken();return{user:t,token:h}}catch(n){throw console.error("Error signing in",n),n}}async function p(){try{await e(o)}catch(s){throw console.error("Error signing out",s),s}}export{p as a,E as s};
